---
title: "Task 2"
output: html_notebook
editor_options: 
  markdown: 
    wrap: 72
---

```{r}
library(ggplot2)
```

```{r}
set.seed(0)
# make this example reproducible
n <- 12
# generating data
a <- function(k) {
  res <- (k * log(k * k * n + pi))
  return(res - floor(res))
}
X <- seq(1, 100)
for (idx in 1:100) {
  X[idx] = qnorm(a(idx))
}
Y <- seq(1, 50)
for (idx in 1:50) {
  Y[idx] = qnorm(a(idx+100))
}
# X
# Y
```

# Task 2

### Andrea Kozlovskyy

#### To test the equality of variances of two normal populations we use upper-tailed f-test. From task 3.a we can see that these two populations are indeed normal. Our test statistic will be: $$ F (x, y) = S_x^2 / S_y^2$$, where$$ S^2 $$ is a sample variance. From this we can construct our rejection region: $$ C_{\alpha} = \brace F (x, y) >  F (\alpha, n-1, m-1)$$

## Calculating by hand

```{r}
var_x = var(X)
var_y = var(Y)

f_score = max(var_x, var_y) / min(var_x, var_y)

f_score

f_critical <- qf(0.05, 99, 49)

f_critical
```

#### As our data calculated manually is bigger than our critical value, the null hypothesis must be rejected.

```{r}
res.ftest <- var.test(X, Y, alternative = "greater", conf.level = 0.95)
res.ftest
```

### As we can see, the obtained by calculating manually and using built-in function match.

## Ploting data

```{r}
x_range <- c(0, 100)

ggplot(data.frame(x = c(0, 2.5)), aes(x)) +
  stat_function(fun = df,args = list(df1 = 99, df2 = 49)) +
  geom_vline(aes(xintercept = res.ftest$statistic, linetype = "dashed", color = "blue"))+
  annotate("text", x=res.ftest$statistic-0.09, y=0.15, label="f-score", angle=90)+
  geom_vline(aes(xintercept = f_critical, linetype = "dashed", color = "red"))+
  annotate("text", x=f_critical-0.09, y=0.15, label="f-critical", angle=90)
```
